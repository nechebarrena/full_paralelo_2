//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
#include "full_p_2.h"




int main(int argc, char *argv[]){
//////////////////////////////////////////////////////////////////////////////////////////////////////    
  
  np=atoi(argv[1]);
  np_1=np;
  int t=0;
  int t_aux=0;
  double tiempo_total=0.0;
  int bandera_columna=23;
//////////////////////////////////////////////////////////////////////////////////////////////////////    
  alocar_variables();
  inicializar_variables();
  delta_tiempo();
  tiempo_total=delta_t*iteraciones;
  bandera=0;  
  t=1;
  
  printf("\n\n.... Programa full V 2.0 .... Corriendo en %i procesadores\n\n\n",np);
  printf("El tama√±o del recinto es %i columnas X %i filas\n",TAM_C,TAM_F);
  printf("mu_w = %f	mu_n = %f\n",mu_w,mu_n);
  printf("La presion capilar es %f \n",po);
  
  calcular_lambdas();
  
/*  
//////////////////////////////////////////////////////////////////////////////////////////////////////    
  while(bandera==0  ){
  //for(t=1 ; t<= iteraciones ; t++){ // Inicio del FOR
  
  calcular_lambdas();
  calcular_presion_capilar();
  calcular_termino_presion_capilar();
  
  t_aux=0;
  diferencia=0.001;
///////////////////////////////////////// Calculo de presion /////////////////////////////////////////  
  if(t==1){  // Inicio del IF ...... Solo para la primera vez que calculo las presiones
   while(diferencia>error && t_aux<10000000){ 
    calculo_presion_paralelo();
    t_aux = t_aux +1;
    //printf("\n %i",t_aux);
   }
  }// Fin del IF
  
  
  if(t>1){  // Inicio del IF ....... Para todas las veces restantes
   //np_1=1; 
   while(diferencia>error_1 && t_aux<300){ 
    calculo_presion_paralelo();
    t_aux = t_aux +1;
   }
  }  // Fin del IF
//////////////////////////////////////////////////////////////////////////////////////////////////////  
  calcular_presion_w();
  calcular_presion_n();
  calcular_lambdas();
  calcular_velocidades();
  calculo_velocidad();
  calcular_f_w();
///////////////////////////////////  Calculo de saturacion  //////////////////////////////////////////  
  calculo_saturacion();
//////////////////////////////////////////////////////////////////////////////////////////////////////  
  calculo_integral();
  integral_total[t]=*integral;
  printf("\r Tiempo= %f/%f [ %.3f %%]  iteraciones= %i ",t*delta_t,tiempo_total,(t*delta_t*100)/(tiempo_total),t_aux);
  fflush(stdout);
  t=t+1;
  control_bandera(bandera_columna);
  if(bandera==1){
    guardar_o(saturacion,bandera_columna);
    bandera_columna=bandera_columna +1;
    }
  bandera=0;
  control_bandera(control);
  }  // Fin del FOR  
*/  
//////////////////////////////////////////////////////////////////////////////////////////////////////    
  printf("\n \n \n Delta_T = %.15f    Tiempo Total=%.15f\n \n",delta_t,tiempo_total);
  printf("\n \n \n.... FIN ....\n \n");
  guardar_v(integral_total,iteraciones);
  guardar_1(saturacion);
  guardar_2(presion);
  guardar_o(lambda_d,2);
//////////////////////////////////////////////////////////////////////////////////////////////////////    
  
  
  
  
  /*
  calcular_lambdas();
  guardar_o(lambda_d_1,1);
  guardar_o(lambda_d_2,2);
  guardar_o(lambda_d_3,3);
  guardar_o(lambda_d_4,4);
  */
  
  
  return 0;
}

//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
//////////////////////////////////////////////////////////////////////////////////////////////////////    
